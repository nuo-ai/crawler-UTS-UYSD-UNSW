# Canva 数据转换器使用说明

本文档旨在指导您如何使用本项目的Web工具，将爬虫生成的房源数据Excel文件，转换为适用于Canva“批量创建”功能的格式。

## 工作流程

整个工作流程分为两个主要步骤：

1.  **数据抓取**：运行爬虫脚本，从网站上获取最新的房源数据。
2.  **格式转换**：使用Web转换器，将抓取到的数据文件处理成Canva兼容的格式。

---

### 第一步：运行爬虫 (`crawler/v5_furniture.py`)

1.  **配置URL**:
    *   打开 `crawler/config/url.txt` 文件。
    *   在文件中填入您想要抓取的Domain.com.au搜索结果页面的URL，每行一个。
    *   如果您需要一次性地、临时地抓取某些URL，可以编辑 `crawler/config/temp_urls.txt`。如果这个文件中有内容，爬虫会优先使用它。

2.  **运行脚本**:
    *   打开您的终端，确保您位于项目的根目录 (`dist/`)。
    *   运行以下命令：
        ```bash
        python crawler/v5_furniture.py
        ```

3.  **检查输出**:
    *   脚本运行完毕后，会在 `crawler/output/` 目录下生成一个或多个带有时间戳的 `.xlsx` 文件。这些就是我们下一步需要用到的源数据文件。

---

### 第二步：使用Web转换器 (`canva_converter/web_generate_canva_sheet.py`)

Web转换器提供了一个简单直观的网页界面，让您可以手动上传一个或多个Excel文件进行转换。

1.  **安装/更新依赖库** (仅首次使用或更新后需要):
    *   在终端中运行以下命令，确保安装了所有必需的库：
        ```bash
        pip install -r requirements.txt
        ```

2.  **启动Web服务器**:
    *   在终端中运行以下命令来启动Web应用：
        ```bash
        python canva_converter/web_generate_canva_sheet.py
        ```

3.  **使用Web界面进行转换**:
    *   服务器启动后，您会在终端看到类似 `* Running on http://127.0.0.1:5001/` 的提示。
    *   在您的网页浏览器中打开这个地址：**http://127.0.0.1:5001**
    *   您会看到一个上传页面。您可以**点击上传区域**或**直接将文件拖拽**到区域内，从 `crawler/output/` 目录中选择一个或多个您想要转换的 `.xlsx` 文件。
    *   选择文件后，点击“上传并转换”按钮。
    *   页面将跳转到结果页，显示所有成功转换的文件列表。
    *   点击每个文件名旁边的“下载”按钮，即可保存转换好的Canva文件。

### 输出文件

通过Web界面下载的文件可以直接用于Canva的批量创建功能。文件会保存在您浏览器的默认下载位置。
